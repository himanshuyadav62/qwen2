<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM Response Streaming</title>
</head>
<body>
    <div>
        <input type="text" id="prompt-input" placeholder="Enter your prompt">
        <button id="generate-button">Generate</button>
    </div>
    <div id="response-container"></div>

    <script>
        async function streamGenerateText(prompt) {
            const response = await fetch('http://localhost:5000/generate', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ prompt: prompt }),
            });

            const reader = response.body.getReader();
            const decoder = new TextDecoder();
            let fullResponse = '';

            while (true) {
                const { done, value } = await reader.read();
                if (done) break;
                
                const chunk = decoder.decode(value);
                const lines = chunk.split('\n\n').filter(line => line.trim() !== '');
                
                for (const line of lines) {
                    if (line.startsWith('data: ')) {
                        const data = JSON.parse(line.slice(6));
                        if (data.response) {
                            fullResponse += data.response;
                            updateUI(fullResponse);
                        }
                    }
                }
            }
        }

        function updateUI(text) {
            const responseElement = document.getElementById('response-container');
            responseElement.textContent = text;
        }

        document.getElementById('generate-button').addEventListener('click', () => {
            const prompt = document.getElementById('prompt-input').value;
            document.getElementById('response-container').textContent = ''; // Clear previous response
            streamGenerateText(prompt);
        });
    </script>
</body>
</html>